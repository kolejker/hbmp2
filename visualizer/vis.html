<!DOCTYPE html>
<html>
  <head>
    <title>Music Visualizer</title>
    <style>
      canvas {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 150px;
        z-index: -1;
      }
    </style>
  </head>
  <body>
    <audio id="audioPlayer" src="file.mp3"></audio>
    <canvas id="visualizer"></canvas>

    <script>
      const audioPlayer = document.getElementById("audioPlayer");
      const canvas = document.getElementById("visualizer");
      const canvasCtx = canvas.getContext("2d");
      let audioCtx, analyser, source, frequencyData;

      // Initialize audio context and analyzer
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      analyser = audioCtx.createAnalyser();
      source = audioCtx.createMediaElementSource(audioPlayer);
      source.connect(analyser);
      analyser.connect(audioCtx.destination);
      frequencyData = new Uint8Array(analyser.frequencyBinCount);

      // Set canvas dimensions
      canvas.width = window.innerWidth;
      canvas.height = 150;

      // Draw visualizer on every frame
      function drawVisualizer() {
        requestAnimationFrame(drawVisualizer);
        analyser.getByteFrequencyData(frequencyData);
        canvasCtx.fillStyle = "rgba(255, 255, 255, 0.1)";
        canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
        canvasCtx.lineWidth = 2;
        canvasCtx.strokeStyle = "rgb(0, 0, 0)";
        canvasCtx.beginPath();

        let sliceWidth = (canvas.width * 1.0) / frequencyData.length;
        let x = 0;
        for (let i = 0; i < frequencyData.length; i++) {
          let v = frequencyData[i] / 128.0;
          let y = (v * canvas.height) / 2;
          if (i === 0) {
            canvasCtx.moveTo(x, y);
          } else {
            canvasCtx.lineTo(x, y);
          }
          x += sliceWidth;
        }

        canvasCtx.lineTo(canvas.width, canvas.height / 2);
        canvasCtx.stroke();
      }

      // Start playing audio and drawing visualizer
      audioPlayer.play();
      drawVisualizer();
    </script>
  </body>
</html>
